# Code Patterns

> Stub generated by init-project-fast. Run `/update-arch` to expand.

## Overview

Key patterns used throughout the NoizuPromptLingo codebase.

## Patterns

### Markdown-as-Code
Agent definitions, syntax rules, and personas are structured markdown files. The "codebase" is documentation that defines LLM behavior.

**Location**: `/npl/`, `/core/agents/`
**Usage**: Define agent capabilities, syntax rules, and behavioral constraints in markdown with special syntax blocks.

### Hierarchical Loading
NPL uses environment variable-based path resolution with fallback chains.

**Location**: `core/scripts/npl-load`
**Usage**: `$NPL_HOME` → project → user → system paths. Tracks loaded items via `--skip` flags.

### Event-Sourced Chat
Chat system stores all interactions as typed events with JSON payloads.

**Location**: `mcp-server/src/npl_mcp/chat/rooms.py`
**Usage**: Events include message, emoji_reaction, artifact_share, todo_create, persona_join/leave.

### Manager/Service Pattern
MCP server uses dedicated manager classes for each domain area.

**Location**: `mcp-server/src/npl_mcp/artifacts/`, `chat/`
**Usage**: ArtifactManager, ReviewManager, ChatManager encapsulate business logic and database operations.

### Base64 Content Transfer
Binary content transferred as base64-encoded strings through MCP protocol.

**Location**: `mcp-server/src/npl_mcp/server.py`
**Usage**: Artifact file contents encoded/decoded for MCP tool transport.

## Details

(Expand with `/update-arch` when detailed documentation needed)
