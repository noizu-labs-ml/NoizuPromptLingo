#!/usr/bin/env bash
# -----------------------------------------------------------------------------
# git-tree
#
# Description:
#   Displays a tree of files under a given target folder in a Git repository,
#   respecting .gitignore. Uses `git ls-files` to determine visible files and
#   `tree --fromfile` to render the directory tree.
#
# Usage:
#   ./git-tree [target-folder]
#
# Examples:
#   ./git-tree
#   ./git-tree deployments/impact-simulation
#
# Requirements:
#   - Must be run inside a Git repository
#   - Requires `tree` installed
# -----------------------------------------------------------------------------

set -euo pipefail

TARGET="${1:-.}"

git rev-parse --is-inside-work-tree >/dev/null 2>&1 || {
  echo "Error: not inside a git repository." >&2
  exit 1
}

ROOT="$(git rev-parse --show-toplevel)"
cd "$ROOT"

git ls-files --cached --others --exclude-standard -- "$TARGET" | tree --fromfile

